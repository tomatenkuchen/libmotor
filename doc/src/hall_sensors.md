# Hall Sensors

If you already skimmed over the PLL part, you'll have an idea of how vital and
yet how tricky rotor position and speed estimation can be. Especially for slow
speeds we're back to guesswork or high frequency injection. Both have their
drawbacks.

If you want to avoid the whole issue and your motor is fit for that, why not
try to apply some sensors to it?

## The What

Hall sensors are semiconducting snippets that emit a voltage if penetrated with
a magnetic field. On motor control projects you'll find hall sensors in 2
different domains:

1. current sensing
2. position sensing

Since all currents emit magnetic fields, it's easy to sense currents with hall
sensors. As a benefit, sensing can be done galvanically isolated. That's super
useful in many applications, where shunts aren't viable because of potentials.

Hall sensors can also be used to sense the magnetic field generated by the
rotor. In this case, hall sensor's output is a logic high or low level,
depending if their magnetic threshold is reached.

## The How

Ordered in a 120° separation, 3 hall sensors can be used to measure the rotor's
position with a 60° certainty. For many applications, this is enough to power
a motor with good efficiency and few vibrations, especially if its rotor flux
is more trapezoidal than sinosoidal (happens with some BLDC motors).

An efficient and easy way to implement a rotor position measurement algorithm
is to trigger an interrupt every time a state change occurs on one of the hall
outputs. In the interrupt routine we look up which sector the rotor is in - et
voilá: rotor position and its derivative is somewhat given with little to no
calculation effort.

If we feel that our motor is vibrating too much, or is loosing power, and
sensors are still an option, we can improve our hall input by measuring the
time between hall state changes. This way, we know quite precisely how fast the
rotor is spinning (60° per measured time). And with the speed in our hands we
easily can interpolate the rotor position between state changes and have a
smooth  transition between sectors.

## The Ugly

Speaking of sensors: they are cool if you have them. But to quote the good old
Kalashnikov:

Things that are complex are not useful, things that are useful are simple

There's much truth to that. Adding sensors to your design reduces a lot of
complexity on your controller side. But it's not entirely gone. It just moved
to your motor, which has to deal now with a sensor system it cannot interfere
with. What if a sensor breaks? Or a connector? Will I need to mount a reference
magnet to the rotor? Will it hold? How much does it cost?

Think twice before going the sensor route. If you happen to have a motor that
already supports them, or if you look for a low speed, position critical
application, a sensor will do you a favor.
If you're designing a fan with high speed and low accuracy, you better stick
to the math.
